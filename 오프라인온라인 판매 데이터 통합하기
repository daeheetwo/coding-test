SELECT DATE_FORMAT(ONLINE_SALE.SALES_DATE, '%Y-%m-%d') AS SALES_DATE, 
       ONLINE_SALE.PRODUCT_ID, 
       COALESCE(ONLINE_SALE.USER_ID, NULL) AS USER_ID, 
       (ONLINE_SALE.SALES_AMOUNT + OFFLINE_SALE.SALES_AMOUNT) AS SALES_AMOUNT
FROM ONLINE_SALE
INNER JOIN OFFLINE_SALE 
ON ONLINE_SALE.PRODUCT_ID = OFFLINE_SALE.PRODUCT_ID 
AND ONLINE_SALE.SALES_DATE = OFFLINE_SALE.SALES_DATE
WHERE ONLINE_SALE.SALES_DATE BETWEEN '2022-03-01' AND '2022-03-31'
ORDER BY SALES_DATE ASC, PRODUCT_ID ASC, USER_ID ASC;
